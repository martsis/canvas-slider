!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);var n=function t(e){var i=e.width,n=e.height,s=e.blur;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.width=i,this.height=void 0!==n?n:i,this.blur=s,this.data=[];for(var a=(this.width-this.width%2)/2,h=(this.height-this.height%2)/2,r=a<h?a:h,o=0;o<this.width;o++){this.data[o]=[];for(var d=0;d<this.height;d++){var c=Math.sqrt(Math.pow(o-a,2)+Math.pow(d-h,2));c<=r?c>r-this.blur?this.data[o][d]=(c-(r-this.blur))/this.blur*255:this.data[o][d]=0:this.data[o][d]=255}}};function s(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=function(){function t(e){var i=this,s=e.canvas,a=e.image,h=e.url,r=e.width,o=e.height,d=e.pattern,c=e.drawn,l=e.hover,u=e.container;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),void 0!==s&&(this.canvas=s),"string"==typeof u&&(this.container=u,this._containerElement=document.querySelector(u)),void 0!==a?(this.image=a,this.image.crossOrigin="anonymous"):(void 0!==h&&(this.url=h),"string"==typeof this.url?(this.image=new Image,this.image.crossOrigin="anonymous",this.image.src=this.url):console.log("url empty")),this.pattern=void 0===d?new n({width:100,height:100,blur:20}):d,this._mouseDownState=!1,this._backup,this.hover=void 0!==l&&l,this.drawn=void 0!==c&&c,this.canvas=document.createElement("canvas"),this._ctx=this.canvas.getContext("2d"),void 0!==this._containerElement&&this._containerElement.append(this.canvas),this.image.addEventListener("load",(function(t){i.width=void 0!==r?r:t.target.width,i.height=void 0!==o?o:t.target.height,i.canvas.height=i.height,i.canvas.width=i.width;var e=i.width/i.height;if(t.target.width/t.target.height>e){var n=-(t.target.width-t.target.height*e)/2*(i.height/t.target.height),s=t.target.width*(i.height/t.target.height);i._ctx.drawImage(t.target,n,0,s,i.height)}else{var a=-(t.target.height-i.height*(t.target.width/i.width))/2,h=t.target.height*(i.width/t.target.width);i._ctx.drawImage(t.target,0,a,i.width,h)}i.save(),(i.hover||i.drawn)&&window.addEventListener("mousemove",(function(t){if(!i.drawn||i._mouseDownState){var e=t.pageX-window.scrollX-i.canvas.getBoundingClientRect().x,n=t.pageY-window.scrollY-i.canvas.getBoundingClientRect().y;i.draw(e,n)}})),i.canvas.addEventListener("mousedown",(function(t){i.drawn&&(i._mouseDownState=!0,i.draw(t.offsetX,t.offsetY))})),i.canvas.addEventListener("mouseup",(function(){i.drawn&&(i._mouseDownState=!1)}))}))}var e,i,a;return e=t,(i=[{key:"save",value:function(){this._backup=this._ctx.getImageData(0,0,this.width,this.height)}},{key:"restore",value:function(){this._ctx.putImageData(this._backup,0,0)}},{key:"draw",value:function(t,e){if(!(t<-this.pattern.width/2||t>this.width+this.pattern.width/2||e<-this.pattern.height/2||e>this.height+this.pattern.height/2)){for(var i=this.width/this.canvas.offsetWidth*t,n=this.height/this.canvas.offsetHeight*e,s=i-this.pattern.width/2,a=n-this.pattern.height/2,h=this._ctx.getImageData(s,a,this.pattern.width,this.pattern.height),r=0,o=3;o<h.data.length;o+=4){var d=r%this.pattern.width,c=(r-r%this.pattern.height)/this.pattern.width;r++;try{h.data[o]&&h.data[o]>this.pattern.data[c][d]&&(h.data[o]=this.pattern.data[c][d])}catch(t){}}this._ctx.putImageData(h,s,a)}}}])&&s(e.prototype,i),a&&s(e,a),t}();function h(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}i.d(e,"default",(function(){return r}));var r=function(){function t(e){var i=this,s=e.container,h=e.width,r=e.height,o=e.slides,d=e.pattern,c=e.nextBtn,l=e.prevBtn,u=e.drawn,v=e.hover,p=e.onNext,f=e.onPrev,g=e.slideSelector,w=e.loop,x=e.lazy;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),void 0!==s?(this.loop="boolean"==typeof w&&w,this.lazy="boolean"==typeof x&&x,this._element=document.querySelector(s),this.animating=!1,void 0!==h&&(this.width=h),void 0!==r&&(this.height=r),void 0!==c&&(this.nextBtn=document.querySelector(c)),void 0!==l&&(this.prevBtn=document.querySelector(l),this.loop||(this.prevBtn.classList.add("button-disabled"),this.prevBtn.setAttribute("disabled","disabled"))),void 0!==u&&(this.drawn=u),this.hover=void 0!==v&&v,void 0!==p&&(this.onNext=p),void 0!==f&&(this.onPrev=f),this.slideSelector=void 0!==g?"".concat(s," ").concat(g):"".concat(s," img"),this.slides=[],void 0===o&&(o=[]),document.querySelectorAll(this.slideSelector).forEach((function(t){i.lazy?o.push(t.getAttribute("data-src")):t.src&&o.push(t.src),t.remove()})),this._pattern=new n(d),o.forEach((function(t){var e=new a({url:t,width:i.width,height:i.height,pattern:i._pattern,drawn:i.drawn,hover:i.hover});e.image.addEventListener("load",(function(){i.resize()}));var n=document.createElement("div");n.className="canvasSlideshow-slide",n.append(e.canvas),i.slides.push({slide:e,container:n})})),this.currentIndex=0,this._nextIndex=this.currentIndex+1,this._slideshowContainer=document.createElement("div"),this._slideshowContainer.className="canvasSlideshow-container",this._element.append(this._slideshowContainer),this.slides.forEach((function(t){i._slideshowContainer.append(t.container)})),this._indexUpdateStart(),this._indexUpdateFinish(),window.addEventListener("resize",(function(){i.resize()})),this.nextBtn&&this.nextBtn.addEventListener("click",(function(t){t.preventDefault(),i.next()})),this.prevBtn&&this.prevBtn.addEventListener("click",(function(t){t.preventDefault(),i.prev()}))):console.error('Param "container" is undefined')}var e,i,s;return e=t,(i=[{key:"_indexUpdateStart",value:function(){var t=this;this.slides.forEach((function(e,i){i==t.currentIndex&&(e.container.style.zIndex=1e3),i==t._nextIndex&&(e.container.style.zIndex=990)}))}},{key:"_indexUpdateFinish",value:function(){var t=this;this.slides.forEach((function(e,i){i!=t.currentIndex&&i!=t._nextIndex&&(e.container.style.zIndex=0)}))}},{key:"resize",value:function(){this._containerHeight=this.slides[0].container.offsetHeight,this._element.style.height="".concat(this._containerHeight,"px")}},{key:"next",value:function(){this.animating||!this.loop&&this.currentIndex>=this.slides.length-1||(this.onNext&&this.onNext(),this.loop||void 0===this.prevBtn||(this.prevBtn.classList.remove("button-disabled"),this.prevBtn.removeAttribute("disabled")),this._nextStart(),this.animation(this.slides[this.currentIndex].slide))}},{key:"prev",value:function(){this.animating||!this.loop&&this.currentIndex<=0||(this.onPrev&&this.onPrev(),this.loop||(this.nextBtn.classList.remove("button-disabled"),this.nextBtn.removeAttribute("disabled")),this._prevStart(),this.animation(this.slides[this.currentIndex].slide))}},{key:"_nextStart",value:function(){this._nextIndex=this.currentIndex,this._nextIndex++,!this.loop&&this._nextIndex>=this.slides.length-1&&(this.nextBtn.classList.add("button-disabled"),this.nextBtn.setAttribute("disabled","disabled")),this._nextIndex>=this.slides.length&&(this._nextIndex=0),this._indexUpdateStart()}},{key:"_prevStart",value:function(){this._nextIndex=this.currentIndex,this._nextIndex--,!this.loop&&this._nextIndex<=0&&(this.prevBtn.classList.add("button-disabledd"),this.prevBtn.setAttribute("disabled","disabled")),this._nextIndex<0&&(this._nextIndex=this.slides.length-1),this._indexUpdateStart()}},{key:"_prevFinish",value:function(){this.currentIndex--,this.currentIndex<0&&(this.currentIndex=this.slides.length-1),this._indexUpdateFinish(),this.slides.forEach((function(t){t.slide.restore()}))}},{key:"_nextFinish",value:function(){this.currentIndex=this._nextIndex,this._indexUpdateFinish(),this.slides.forEach((function(t,e){t.slide.restore()}))}},{key:"animation",value:function(t,e,i){var n=this,s=this._pattern.width/2-this._pattern.blur,a=-s,h=t.width-s,r="down",o=0;if(this.animating=!0,window.innerWidth<768)this.animating=!1,void 0===e?this._nextFinish():this._prevFinish();else var d=setInterval((function(){o>t.width/n._pattern.width*2&&(clearInterval(d),n.animating=!1,void 0===e?n._nextFinish():n._prevFinish()),t.draw(h/(n.width/t.canvas.offsetWidth),a/(n.height/t.canvas.offsetHeight)),"down"==r&&(a>t.height+s||h>t.width+n._pattern.width)&&(h-=n._pattern.width-2*n._pattern.blur,r="up",o++),"up"==r&&(a<-s||h<0)&&(h-=n._pattern.width-2*n._pattern.blur,r="down",o++),"down"==r&&(a+=t.height/20,h+=t.width/20),"up"==r&&(a-=t.height/20,h-=t.width/20)}),1e3/60)}}])&&h(e.prototype,i),s&&h(e,s),t}()}]);
//# sourceMappingURL=canvas-slider.js.map