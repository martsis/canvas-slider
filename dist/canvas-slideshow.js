!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e){class i{constructor({width:t,height:e,blur:i}){this.width=t,this.height=void 0!==e?e:t,this.blur=i,this.data=[];const s=(this.width-this.width%2)/2,n=(this.height-this.height%2)/2,h=s<n?s:n;for(let t=0;t<this.width;t++){this.data[t]=[];for(let e=0;e<this.height;e++){const i=Math.sqrt(Math.pow(t-s,2)+Math.pow(e-n,2));i<=h?i>h-this.blur?this.data[t][e]=(i-(h-this.blur))/this.blur*255:this.data[t][e]=0:this.data[t][e]=255}}}}class s{constructor({url:t,width:e,height:i,pattern:s,drawn:n}){this.url=t,this.image=new Image,this.image.crossOrigin="anonymous",this.image.src=this.url,this._mouseDownState=!1,this.pattern=s,this._backup,this.drawn=void 0!==n&&n,this.canvas=document.createElement("canvas"),this._ctx=this.canvas.getContext("2d"),this.image.addEventListener("load",t=>{this.width=void 0!==e?e:t.target.width,this.height=void 0!==i?i:t.target.height,this.canvas.height=this.height,this.canvas.width=this.width;const s=this.width/this.height;if(t.target.width/t.target.height>s){const e=-(t.target.width-t.target.height*s)/2*(this.height/t.target.height),i=t.target.width*(this.height/t.target.height);this._ctx.drawImage(t.target,e,0,i,this.height)}else{const e=-(t.target.height-this.height*(t.target.width/this.width))/2,i=t.target.height*(this.width/t.target.width);this._ctx.drawImage(t.target,0,e,this.width,i)}this.save()}),this.canvas.addEventListener("mousedown",t=>{this.drawn&&(this._mouseDownState=!0,this.draw(t.offsetX,t.offsetY))}),this.canvas.addEventListener("mouseup",()=>{this.drawn&&(this._mouseDownState=!1)}),this.canvas.addEventListener("mousemove",t=>{this._mouseDownState&&this.drawn&&this.draw(t.offsetX,t.offsetY)})}save(){this._backup=this._ctx.getImageData(0,0,this.width,this.height)}restore(){this._ctx.putImageData(this._backup,0,0)}resize(){this.canvas.width}draw(t,e){const i=this.width/this.canvas.offsetWidth*t,s=this.height/this.canvas.offsetHeight*e,n=i-this.pattern.width/2,h=s-this.pattern.height/2,a=this._ctx.getImageData(n,h,this.pattern.width,this.pattern.height);let r=0;for(let t=3;t<a.data.length;t+=4){const e=r%this.pattern.width,i=(r-r%this.pattern.height)/this.pattern.width;r++,a.data[t]>this.pattern.data[i][e]&&(a.data[t]=this.pattern.data[i][e])}this._ctx.putImageData(a,n,h)}}class n{constructor({container:t,width:e,height:n,slides:h,pattern:a,nextBtn:r,prevBtn:d,drawn:o,onNext:c,onPrev:l}){void 0!==t?(this._element=document.querySelector(t),this.animating=!1,void 0!==e&&(this.width=e),void 0!==n&&(this.height=n),void 0!==r&&(this.nextBtn=document.querySelector(r)),void 0!==d&&(this.prevBtn=document.querySelector(d)),void 0!==o&&(this.drawn=o),void 0!==c&&(this.onNext=c),void 0!==l&&(this.onPrev=l),this._pattern=new i(a),this.slides=[],this.currentIndex=0,this.nextIndex=this.currentIndex+1,this._slideshowContainer=document.createElement("div"),this._slideshowContainer.className="canvasSlideshow-container",this._element.append(this._slideshowContainer),h.forEach(t=>{const e=new s({url:t,width:this.width,height:this.height,pattern:this._pattern,drawn:this.drawn});e.image.addEventListener("load",()=>{this.resize()});const i=document.createElement("div");i.className="canvasSlideshow-slide",i.append(e.canvas),this.slides.push({slide:e,container:i})}),this.slides.forEach(t=>{this._slideshowContainer.append(t.container)}),this._indexUpdateStart(),this._indexUpdateFinish(),window.addEventListener("resize",()=>{this.resize()}),this.nextBtn&&this.nextBtn.addEventListener("click",t=>{t.preventDefault(),this.next()}),this.prevBtn&&this.prevBtn.addEventListener("click",t=>{t.preventDefault(),this.prev()})):console.error('Param "container" is undefined')}_indexUpdateStart(){this.slides.forEach((t,e)=>{e==this.currentIndex&&(t.container.style.zIndex=1e3),e==this.nextIndex&&(t.container.style.zIndex=990)})}_indexUpdateFinish(){this.slides.forEach((t,e)=>{e!=this.currentIndex&&e!=this.nextIndex&&(t.container.style.zIndex=0)})}resize(){this._containerHeight=this.slides[0].container.offsetHeight,this._element.style.height=`${this._containerHeight}px`}next(){this.animating||(this.onNext&&this.onNext(),this._nextStart(),this.animation(this.slides[this.currentIndex].slide))}prev(){this.animating||(this.onPrev&&this.onPrev(),this._prevStart(),this.animation(this.slides[this.currentIndex].slide))}_nextStart(){this.nextIndex=this.currentIndex,this.nextIndex++,this.nextIndex>=this.slides.length&&(this.nextIndex=0),this._indexUpdateStart()}_prevStart(){this.nextIndex=this.currentIndex,this.nextIndex--,this.nextIndex<0&&(this.nextIndex=this.slides.length-1),this._indexUpdateStart()}_prevFinish(){this.currentIndex--,this.currentIndex<0&&(this.currentIndex=this.slides.length-1),this._indexUpdateFinish(),this.slides.forEach(t=>{t.slide.restore()})}_nextFinish(){this.currentIndex++,this.currentIndex>=this.slides.length&&(this.currentIndex=0),this._indexUpdateFinish(),this.slides.forEach((t,e)=>{t.slide.restore()})}animation(t,e,i){const s=this._pattern.width/2-this._pattern.blur;let n=-s,h=t.width-s,a="down",r=0;this.animating=!0;const d=setInterval(()=>{r>t.width/this._pattern.width*2&&(clearInterval(d),this.animating=!1,void 0===e?this._nextFinish():this._prevFinish()),t.draw(h/(this.width/t.canvas.offsetWidth),n/(this.height/t.canvas.offsetHeight)),"down"==a&&(n>t.height+s||h>t.width+this._pattern.width)&&(h-=this._pattern.width-2*this._pattern.blur,a="up",r++),"up"==a&&(n<-s||h<0)&&(h-=this._pattern.width-2*this._pattern.blur,a="down",r++),"down"==a&&(n+=t.height/20,h+=t.width/20),"up"==a&&(n-=t.height/20,h-=t.width/20)},16)}}document.addEventListener("DOMContentLoaded",(function(){const t=new n({container:"#slideshow",nextBtn:"#next",prevBtn:"#prev",slides:["http://placekitten.com/800/480","http://placekitten.com/800/800","http://placekitten.com/480/800"],width:800,height:640,pattern:{width:320,height:320,blur:10},drawn:!0,onNext:function(){console.log("next")},onPrev:function(){console.log("prev")}});window.slideshow=t}))}]);